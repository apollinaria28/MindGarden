<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ MindGarden</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">

        <!-- –ò–∫–æ–Ω–∫–∞ –¥–ª—è iOS -->
    <link rel="apple-touch-icon" href="icons/icon-152x152.png">

    <!-- –¶–≤–µ—Ç –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞ -->
    <meta name="theme-color" content="#667eea">

    <!-- –î–ª—è iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="MindGarden">

    <!-- –î–ª—è Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ -->
    <meta name="format-detection" content="telephone=no">

    <!-- –û—Ç–∫—Ä—ã–≤–∞—Ç—å —Å—Å—ã–ª–∫–∏ –≤ —ç—Ç–æ–º –∂–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ -->
    <meta name="apple-touch-fullscreen" content="yes">

</head>
<body>
    <div class="container first-launch">
        <div class="welcome-header">
            <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</h1>
            <p class="hello">–í–µ–ª–∏–∫–∏–µ —Ü–∏—Ç–∞—Ç—ã<br> —É–∂–µ –∂–¥—É—Ç —Ç–µ–±—è!</p>
            
        </div>

        <div class="name-input-section">
            <label for="username">–í–∞—à–µ –∏–º—è</label>
            <input type="text" id="username" placeholder="–ö–∞–∫ –∫ –≤–∞–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è?">
        </div>

        <div class="tags-selection">
            <h2>–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ —Ç–µ–º—ã</h2>
            <p class="hint">–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–º:</p>
            <div class="tags-container" id="tagsContainer">
                <!-- –¢–µ–≥–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <p class="selected-count">–í—ã–±—Ä–∞–Ω–æ: <span id="selectedCount">0</span> —Ç–µ–º</p>
        </div>

        <div class="actions">
            <button class="btn" id="continueBtn" disabled>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
            <button class="btn-secondary" id="skipBtn">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã</button>
        </div>

        <div class="info-box">
            <p>üí° <strong>–°–æ–≤–µ—Ç:</strong> –í—ã –≤—Å–µ–≥–¥–∞ —Å–º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ç–µ–º—ã –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.</p>
        </div>
    </div>

    <script src="db.js"></script>
    <script>
        // –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–µ–≥–æ–≤
        const availableTags = [
            { id: 'motivation', name: '–ú–æ—Ç–∏–≤–∞—Ü–∏—è',},
            { id: 'philosophy', name: '–§–∏–ª–æ—Å–æ—Ñ–∏—è'},
            { id: 'success', name: '–£—Å–ø–µ—Ö'},
            { id: 'wisdom', name: '–ú—É–¥—Ä–æ—Å—Ç—å'},
            { id: 'love', name: '–õ—é–±–æ–≤—å'},
            { id: 'life', name: '–ñ–∏–∑–Ω—å'},
            { id: 'inspiration', name: '–í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ'},
            { id: 'happiness', name: '–°—á–∞—Å—Ç—å–µ'},
            { id: 'work', name: '–†–∞–±–æ—Ç–∞'},
            { id: 'creativity', name: '–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å'},
            { id: 'nature', name: '–ü—Ä–∏—Ä–æ–¥–∞'},
            { id: 'spirituality', name: '–î—É—Ö–æ–≤–Ω–æ—Å—Ç—å'}
        ];

        let selectedTags = [];

        async function init() {
            const tagsContainer = document.getElementById('tagsContainer');
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—Å–µ —Ç–µ–≥–∏
            availableTags.forEach(tag => {
                const tagElement = document.createElement('div');
                tagElement.className = 'tag-select';
                tagElement.innerHTML = `
                    <input type="checkbox" id="tag_${tag.id}" value="${tag.id}">
                    <label for="tag_${tag.id}">
                        <span class="tag-name">${tag.name}</span>
                    </label>
                `;
                
                tagElement.querySelector('input').addEventListener('change', function() {
                    if (this.checked) {
                        selectedTags.push(tag.id);
                    } else {
                        selectedTags = selectedTags.filter(t => t !== tag.id);
                    }
                    updateSelectedCount();
                });
                
                tagsContainer.appendChild(tagElement);
            });
            
            // –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
            document.getElementById('continueBtn').addEventListener('click', async () => {
                await saveUserSelection();
                window.location.href = 'index.html';
            });
            
            // –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å
            document.getElementById('skipBtn').addEventListener('click', async () => {
                selectedTags = ['motivation', 'inspiration', 'wisdom']; // –ë–∞–∑–æ–≤—ã–µ —Ç–µ–≥–∏
                await saveUserSelection();
                window.location.href = 'index.html';
            });
        }
        
        function updateSelectedCount() {
            const count = selectedTags.length;
            document.getElementById('selectedCount').textContent = count;
            document.getElementById('continueBtn').disabled = count === 0;
        }
        
        async function saveUserSelection() {
            const username = document.getElementById('username').value.trim() || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
            const db = await initDB();
            
            // –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            await db.saveUser({
                username: username,
                selectedTags: selectedTags,
                settings: {
                    notifications: true,
                    notificationTime: '09:00',
                    theme: 'light'
                },
                createdAt: new Date().toISOString(),
                stats: {
                    quotesReceived: 0,
                    favoritesCount: 0,
                    lastQuoteDate: null
                }
            });
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ü–∏—Ç–∞—Ç—ã –≤ –±–∞–∑—É
            await loadQuotes();
        }
        
        async function loadQuotes() {
            try {
                const response = await fetch('quotes.json');
                const quotes = await response.json();
                
                const db = await initDB();
                await db.saveQuotes(quotes);
                
                console.log('–¶–∏—Ç–∞—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ü–∏—Ç–∞—Ç:', error);
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>